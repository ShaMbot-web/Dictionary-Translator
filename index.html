<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üåç ShaMbot Translator</title>
<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background-image: url('background.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

.container {
  background: rgba(0,0,0,0.7);
  padding: 30px;
  border-radius: 16px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
  width: 500px;
  text-align: center;
  max-height: 90vh;
  overflow-y: auto;
  color: #fff;
}

h1 {
  margin-bottom: 20px;
  font-size: 22px;
  color: #ffb6c1;
}

input {
  width: 70%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 10px;
}

.btn-container {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 10px;
  flex-wrap: wrap;
}

button {
  padding: 10px 15px;
  border: none;
  border-radius: 8px;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: 0.3s;
}

.search-btn { background: #4facfe; }
.search-btn:hover { background: #007bff; }

.clear-btn { background: #ff6b6b; }
.clear-btn:hover { background: #e84141; }

.results {
  margin-top: 20px;
  text-align: left;
}

.section-title {
  font-size: 18px;
  margin: 15px 0 10px;
  border-bottom: 2px solid #eee;
  padding-bottom: 5px;
  color: #fff;
}

.translation, .definition {
  background: #222;
  padding: 10px;
  border-radius: 10px;
  margin-bottom: 10px;
}

.translation {
  display: flex;
  align-items: center;
}

.translation img {
  width: 28px;
  height: 20px;
  margin-right: 10px;
  border-radius: 3px;
  object-fit: cover;
}

/* Sidebar menu */
.floating-menu {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
}

.menu-icon {
  width: 40px;
  height: 40px;
  cursor: pointer;
  border-radius: 8px;
  background: #fff;
}

.menu-panel {
  position: fixed;
  top: 70px;
  right: 20px;
  background: #fff;
  border-radius: 8px;
  width: 220px;
  max-height: 80vh;
  overflow-y: auto;
  display: none;
  flex-direction: column;
  z-index: 999;
  padding-bottom: 10px;
}

.menu-panel.active { display: flex; }

.menu-panel-header {
  font-weight: bold;
  padding: 10px;
  border-bottom: 1px solid #ccc;
  text-align: center;
}

.menu-panel button {
  background: transparent;
  color: #000;
  padding: 10px;
  width: 100%;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 8px;
  border: none;
  cursor: pointer;
}

.menu-panel button:hover {
  background: rgba(0,0,0,0.05);
}

.menu-panel img { width: 20px; height: 20px; }

.menu-content {
  padding: 5px 10px;
  overflow-y: auto;
}

.menu-content ul { list-style: inside; padding-left: 0; margin: 0; }
.menu-content li { padding: 3px 0; }

.see-more-btn {
  background: #4facfe;
  margin-top: 10px;
  width: auto;
  border-radius: 6px;
}

.loader-container {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.loader-container img {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  object-fit: cover;
}

.loader-label {
  margin-top: 5px;
  color: #fff;
}
#statusIndicator {
  position: fixed;
  bottom: 15px;
  right: 20px;
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
  font-size: 14px;
  padding: 8px 14px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(0,0,0,0.4);
  z-index: 9999;
  transition: background 0.3s;
}

#statusIndicator.online { background: rgba(40, 167, 69, 0.8); } /* Green */
#statusIndicator.offline { background: rgba(220, 53, 69, 0.8); } /* Red */

</style>
</head>
<body>

<!-- Floating Menu -->
<div class="floating-menu">
  <img src="https://creazilla-store.fra1.digitaloceanspaces.com/icons/3206632/menu-icon-md.png" 
       class="menu-icon" onclick="toggleMenu()" alt="Menu Icon">
</div>

<!-- Sidebar Panel -->
<div class="menu-panel" id="menuPanel">
  <div class="menu-panel-header">Menu</div>
  <button onclick="showHistoryInPanel()">
    <img src="https://cdn-icons-png.flaticon.com/512/8373/8373545.png"> History
  </button>
  <button onclick="showWorkingWordsInPanel()">
    <img src="https://www.nicepng.com/png/detail/309-3093011_notepad-pen-writing-pad-pencil-paper-icon-check.png"> Working Words
  </button>
  <div class="menu-content" id="menuContent">
    <p style="text-align:center;color:#999;">Select a section</p>
  </div>
</div>

<div class="container">
  <h1>ShaMbot Translator</h1>
  <input type="text" id="wordInput" placeholder="Enter an English word...">

  <div class="btn-container">
    <button class="search-btn" onclick="lookupWord()">Search</button>
    <button class="clear-btn" onclick="clearResults()">Clear</button>
  </div>

  <div id="results"></div>
</div>

<script>
// Hybrid Translation Database
const translationDB = {
  "Media": { "es": "Medios", "fr": "M√©dias", "de": "Medien", "ja": "„É°„Éá„Ç£„Ç¢", "tl": "Midya" },
  "Information": { "es": "Informaci√≥n", "fr": "Information", "de": "Information", "ja": "ÊÉÖÂ†±", "tl": "Impormasyon" },
  "Literacy": { "es": "Alfabetizaci√≥n", "fr": "Litt√©ratie", "de": "Alphabetisierung", "ja": "„É™„ÉÜ„É©„Ç∑„Éº", "tl": "Kakayahan sa Pagbasa" },
  "Digital": { "es": "Digital", "fr": "Num√©rique", "de": "Digital", "ja": "„Éá„Ç∏„Çø„É´", "tl": "Digital" },
  "Communication": { "es": "Comunicaci√≥n", "fr": "Communication", "de": "Kommunikation", "ja": "„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥", "tl": "Komunikasyon" },
  "Book": { "es": "Libro", "fr": "Livre", "de": "Buch", "ja": "Êú¨", "tl": "Aklat" },
  "House": { "es": "Casa", "fr": "Maison", "de": "Haus", "ja": "ÂÆ∂", "tl": "Bahay" },
  "Love": { "es": "Amor", "fr": "Amour", "de": "Liebe", "ja": "ÊÑõ", "tl": "Pag-ibig" },
  "Computer": { "es": "Computadora", "fr": "Ordinateur", "de": "Computer", "ja": "„Ç≥„É≥„Éî„É•„Éº„Çø", "tl": "Kompyuter" },
  "Food": { "es": "Comida", "fr": "Nourriture", "de": "Essen", "ja": "È£ü„ÅπÁâ©", "tl": "Pagkain" }
};

const languages = {
  "es": { name: "Spanish", flag: "https://flagcdn.com/es.svg" },
  "fr": { name: "French", flag: "https://flagcdn.com/fr.svg" },
  "de": { name: "German", flag: "https://flagcdn.com/de.svg" },
  "ja": { name: "Japanese", flag: "https://flagcdn.com/jp.svg" },
  "tl": { name: "Filipino", flag: "https://flagcdn.com/ph.svg" }
};

const wordInput = document.getElementById('wordInput');
const resultsDiv = document.getElementById('results');
const menuPanel = document.getElementById('menuPanel');
const menuContent = document.getElementById('menuContent');
let historyList = JSON.parse(localStorage.getItem("shambotHistory")) || [];
const wordsList = Object.keys(translationDB);

// Capitalize input
wordInput.addEventListener('input', () => {
  let val = wordInput.value;
  if(val.length > 0) wordInput.value = val.charAt(0).toUpperCase() + val.slice(1).toLowerCase();
});

// Press Enter to search
wordInput.addEventListener('keydown', e => { if(e.key === "Enter") lookupWord(); });

// Toggle sidebar
function toggleMenu(){ menuPanel.classList.toggle('active'); }

// Main lookup
async function lookupWord(){
  const word = wordInput.value.trim();
  if(!word){ resultsDiv.innerHTML="<p>Please type a word.</p>"; return; }

  // Add to history if new
  if(!historyList.includes(word)) {
    historyList.push(word);
    localStorage.setItem("shambotHistory", JSON.stringify(historyList));
  }

  resultsDiv.innerHTML = `<div class="loader-container">
    <img src="https://media.giphy.com/media/ppSjX2iP9Ec1ExJRsV/giphy.gif">
    <div class="loader-label">Loading...</div>
  </div>`;

  let output = "";

  // --- Definition ---
  try {
    if (navigator.onLine) {
      const dictRes = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
      if (dictRes.ok) {
        const dictData = await dictRes.json();
        const meaning = dictData[0]?.meanings[0]?.definitions[0]?.definition || "No definition found.";
        const phonetic = dictData[0]?.phonetic || "";
        output += `<div class="section-title">üìñ Definition</div>
                   <div class="definition"><b>${word}</b> ${phonetic?`(${phonetic})`:""}: ${meaning}</div>`;
      } else throw new Error();
    } else {
      output += `<div class="section-title">üìñ Definition</div>
                 <div class="definition">Offline mode: No definition available.</div>`;
    }
  } catch {
    output += `<div class="section-title">üìñ Definition</div>
               <div class="definition">Definition unavailable.</div>`;
  }

  // --- Translations ---
  output += `<div class="section-title">üåç Translations</div>`;
  for (const [code, info] of Object.entries(languages)) {
    let translated = translationDB[word]?.[code] || "";

    // Try online API if missing locally
    if (!translated && navigator.onLine) {
      try {
        const res = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(word)}&langpair=en|${code}`);
        const data = await res.json();
        translated = data?.responseData?.translatedText?.trim() || "";
        if (!translated || translated.toLowerCase() === word.toLowerCase()) throw new Error();
      } catch {
        translated = "Translation unavailable due to system limits";
      }
    }

    if (!translated) translated = "Translation unavailable due to system limits";

    output += `<div class="translation">
                 <img src="${info.flag}" alt="${info.name} flag">
                 <div><b>${info.name}:</b> ${translated}</div>
               </div>`;
  }

  resultsDiv.innerHTML = output;
  updateStatusIndicator();
}

// Clear results
function clearResults(){
  wordInput.value = "";
  resultsDiv.innerHTML = "";
  wordInput.focus();
}

// Show History
function showHistoryInPanel(){
  const items = historyList.length
    ? historyList.map(w => `<li>${w}</li>`).join("")
    : "<li>No history yet</li>";
  menuContent.innerHTML = `<ul>${items}</ul>`;
}

// Show Working Words
function showWorkingWordsInPanel(){
  const firstThree = wordsList.slice(0,3);
  let content = "<ul>" + firstThree.map(w => `<li>${w}</li>`).join("") + "</ul>";
  if(wordsList.length > 3){
    content += `<button class="see-more-btn" onclick="showMoreWorkingWords()">See More</button>`;
  }
  menuContent.innerHTML = content;
}

function showMoreWorkingWords(){
  menuContent.innerHTML = "<ul>" + wordsList.map(w => `<li>${w}</li>`).join("") + "</ul>";
}

// --- Status Indicator ---
function updateStatusIndicator() {
  const indicator = document.getElementById("statusIndicator");
  if (!indicator) return;
  if (navigator.onLine) {
    indicator.textContent = "üü¢ Online Mode";
    indicator.classList.remove("offline");
    indicator.classList.add("online");
  } else {
    indicator.textContent = "üî¥ Offline Mode";
    indicator.classList.remove("online");
    indicator.classList.add("offline");
  }
}

window.addEventListener("online", updateStatusIndicator);
window.addEventListener("offline", updateStatusIndicator);
updateStatusIndicator();
</script>

</body>
</html>
